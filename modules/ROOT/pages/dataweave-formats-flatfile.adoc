
= Flatfile Format
ifndef::env-site,env-github[]
include::_attributes.adoc[]
endif::[]
:keywords: format, flatfile, */flatfile, application/flatfile

MIME type: `application/flatfile`

ID: `flatfile`
The Flat File format supports multiple types of fixed width records within a single message. The schema structure allows you to define how different record types are distinguished, and how the records are logically grouped.

NOTE: Flat File in DataWeave supports files of up to 15 MB, and the memory requirement is roughly 40 to 1. For example, a 1-MB file requires up to 40 MB of memory to process, so it's important to consider this memory requirement in conjunction with your TPS needs for large flat files. This is not an exact figure; the value might vary according to the complexity of the mapping instructions.

[[examples]]
== Example: Specify a Flat File Schema

This example shows a DataWeave script that outputs data in the Flat File format.
Notice that it uses the `schemaPath` and `structureIndent` writer properties.

[source,dataweave,linenums]
----
%dw 2.0
output application/flatfile schemaPath="src/main/resources/test-data/QBReqRsp.esl", structureIdent="QBResponse"
---
payload
----

// CONFIG PROPS GET APPENDED BELOW /////////////////////////////////


[[properties]]
== Configuration Properties

DataWeave supports the following configuration properties for this format.


[[reader_properties]]
=== Reader Properties

This format accepts properties that provide instructions for reading input data.


[cols="1,1,1,3a", options="header"]
|===
|Parameter |Type |Default|Description
|`enforceRequires`  |`Boolean`|`false`|Produces an error when set to `true` if a required value is missing.

Valid values are `true` or `false`.
|`missingValues`  |`String`|`null`|Specifies one of the following fill characters to represent missing values: 

* `none`: Treats all data as values.
* `spaces`: Interprets a field consisting of only spaces as a missing value. Default for flat file and fixed-width formats. 
* `zeroes`: Interprets numeric fields consisting of only `0` characters _and_ character fields consisting of only spaces as missing values. 
* `nulls`: Interprets a field consisting only of `0` bytes as a missing value. Default for COBOL copybook schema.

Valid values are `none` or `spaces` or `zeroes` or `nulls`.
|`notTruncateDependingOnSubjectNotPresent`  |`Boolean`|`false`|Fills the whole group when the  DEPENDING ON subject is not present.

Valid values are `true` or `false`.
|`recordParsing`  |`String`|`null`|Specifies the expected type of separation between lines or records: 

* `strict`: Line break is expected at exact end of each record. `strict` is the default. 
* `lenient`: Line break is used, but records can be shorter or longer than the schema specifies. 
* `noTerminator`: Records follow one another with no separation. 
* `singleRecord`: The entire input is a single record. 

Note that schemas with type `Binary` or `Packed` don't allow for line break detection, so setting `recordParsing` to `lenient` only allows long records to be handled, not short ones. These schemas also currently only work with certain single-byte character encodings (so not with UTF-8 or any multibyte format).

Valid values are `strict` or `lenient` or `noTerminator` or `singleRecord`.
|`schemaPath` (Required) |`String`|`null`|Path to the schema definition. Specifies the location in your local disk of the schema file that parses your input.
|`segmentIdent`  |`String`|`null`|Segment identifier in the schema for fixed-width or COBOL copybook schemas. Required when parsing a single segment or record definition if the schema includes multiple segment definitions.
|`structureIdent`  |`String`|`null`|Structure identifier in the schema for flat file schemas. Required when parsing a structure definition if the schema includes multiple structure definitions.
|`truncateDependingOn`  |`Boolean`|`false`|Truncates DEPENDING ON COBOL copybook values to the length used.

Valid values are `true` or `false`.
|`zonedDecimalStrict`  |`Boolean`|`false`|Uses the 'strict' ASCII form of sign encoding for zoned decimal values in COBOL copybook.

Valid values are `true` or `false`.
|===

[[writer_properties]]
=== Writer Properties

This format accepts properties that provide instructions for writing output data.

[cols="1,1,1,3a", options="header"]
|===
|Parameter |Type |Default|Description
|`bufferSize`  |`Number`|`8192`|Size of the buffer writer.
|`deferred`  |`Boolean`|`false`|Generates the output as a data stream when set to `true`, and defers the script's execution until consumed.

Valid values are `true` or `false`.
|`encoding`  |`String`|`null`|The character set to use for the output, such as UTF-8.
|`enforceRequires`  |`Boolean`|`false`|Produces an error when set to `true` if a required value is missing.

Valid values are `true` or `false`.
|`missingValues`  |`String`|`null`|Specifies one of the following fill characters to represent missing values: 

* `none`: Treats all data as values.
* `spaces`: Interprets a field consisting of only spaces as a missing value. Default for flat file and fixed-width formats. 
* `zeroes`: Interprets numeric fields consisting of only `0` characters _and_ character fields consisting of only spaces as missing values. 
* `nulls`: Interprets a field consisting only of `0` bytes as a missing value. Default for COBOL copybook schema.

Valid values are `none` or `spaces` or `zeroes` or `nulls`.
|`notTruncateDependingOnSubjectNotPresent`  |`Boolean`|`false`|Fills the whole group when the  DEPENDING ON subject is not present.

Valid values are `true` or `false`.
|`recordTerminator`  |`String`|`null`|Record separator line break

Valid values are `lf` or `cr` or `crlf` or `none`.
|`schemaPath` (Required) |`String`|`null`|Path to the schema definition. Specifies the location in your local disk of the schema file that parses your input.
|`segmentIdent`  |`String`|`null`|Segment identifier in the schema for fixed-width or COBOL copybook schemas. Required when parsing a single segment or record definition if the schema includes multiple segment definitions.
|`structureIdent`  |`String`|`null`|Structure identifier in the schema for flat file schemas. Required when parsing a structure definition if the schema includes multiple structure definitions.
|`trimValues`  |`Boolean`|`false`|Trim values longer than field width

Valid values are `true` or `false`.
|`truncateDependingOn`  |`Boolean`|`false`|Truncates DEPENDING ON COBOL copybook values to the length used.

Valid values are `true` or `false`.
|`zonedDecimalStrict`  |`Boolean`|`false`|Uses the 'strict' ASCII form of sign encoding for zoned decimal values in COBOL copybook.

Valid values are `true` or `false`.
|===


[[mime_types]]
== Supported MIME Types

This format supports the following MIME types.

[cols="1", options="header"]
|===
| MIME Type
|`*/flatfile`
|===
